<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Registro de Jornada</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#2563eb">

<style>
body{font-family:Arial;margin:0;background:#f4f6f9;}
header{background:#1f2937;color:white;padding:15px;text-align:center;font-size:20px;}
nav{display:flex;justify-content:center;background:#374151;}
nav button{background:none;border:none;color:white;padding:14px 20px;cursor:pointer;font-size:15px;}
nav button.active{background:#111827;}
section{display:none;padding:20px;}
section.active{display:block;}
.card{background:white;padding:20px;border-radius:10px;box-shadow:0 3px 10px rgba(0,0,0,0.1);max-width:600px;margin:auto;}
input{width:100%;padding:8px;margin:8px 0;}
button.primary{background:#2563eb;color:white;border:none;padding:10px;width:100%;border-radius:6px;cursor:pointer;}
table{width:100%;border-collapse:collapse;margin-top:20px;}
th,td{border:1px solid #ddd;padding:8px;text-align:center;}
th{background:#e5e7eb;}
</style>
</head>
<body>

<header>ðŸ“Š Sistema de Registro de Jornada</header>

<nav>
<button class="tabBtn active" data-tab="entrada">Entrada</button>
<button class="tabBtn" data-tab="datos">Datos</button>
<button class="tabBtn" data-tab="resumen">Resumen</button>
</nav>

<section id="entrada" class="active">
<div class="card">
<h3>Nuevo Registro</h3>
<label>Fecha</label>
<input type="date" id="fecha">
<label>Hora Entrada</label>
<input type="time" id="entradaHora">
<label>Hora Salida</label>
<input type="time" id="salidaHora">
<button class="primary" onclick="guardar()">Guardar Registro</button>
</div>
</section>

<section id="datos">
<div class="card">
<h3>Registros</h3>
<table id="tabla">
<thead><tr><th>Fecha</th><th>Entrada</th><th>Salida</th><th>Horas</th></tr></thead>
<tbody></tbody>
</table>
</div>
</section>

<section id="resumen">
<div class="card">
<h3>Resumen</h3>
<p>Total Horas: <strong id="totalHoras">0</strong></p>
<p>Horas Laborables: <strong id="horasLaborables">0</strong></p>
<p>Horas Fin de Semana: <strong id="horasFinde">0</strong></p>
</div>
</section>

<script>
let registros = JSON.parse(localStorage.getItem("registros")) || [];

document.querySelectorAll(".tabBtn").forEach(btn=>{
btn.addEventListener("click", function(){
document.querySelectorAll(".tabBtn").forEach(b=>b.classList.remove("active"));
document.querySelectorAll("section").forEach(sec=>sec.classList.remove("active"));
this.classList.add("active");
document.getElementById(this.dataset.tab).classList.add("active");
actualizarTabla();
actualizarResumen();
});
});

function calcularHoras(inicio, fin){
const [h1,m1]=inicio.split(":");
const [h2,m2]=fin.split(":");
let e=new Date(); e.setHours(h1,m1,0);
let s=new Date(); s.setHours(h2,m2,0);
let diff=(s-e)/1000/60/60;
return diff>0?diff:0;
}

function guardar(){
const fecha=document.getElementById("fecha").value;
const entrada=document.getElementById("entradaHora").value;
const salida=document.getElementById("salidaHora").value;
if(!fecha||!entrada||!salida){alert("Completa todos los campos");return;}
const horas=calcularHoras(entrada,salida);
registros.push({id:Date.now(),fecha,entrada,salida,horas});
localStorage.setItem("registros",JSON.stringify(registros));
actualizarTabla();actualizarResumen();
alert("Registro guardado");
}

function actualizarTabla(){
const tbody=document.querySelector("#tabla tbody");
tbody.innerHTML="";
registros.sort((a,b)=>new Date(b.fecha)-new Date(a.fecha))
.forEach(r=>{
tbody.innerHTML+=`<tr>
<td>${r.fecha}</td>
<td>${r.entrada}</td>
<td>${r.salida}</td>
<td>${r.horas.toFixed(2)}</td>
</tr>`;
});
}

function actualizarResumen(){
let total=0,laborables=0,finde=0;
registros.forEach(r=>{
total+=r.horas;
const dia=new Date(r.fecha+"T00:00").getDay();
if(dia===0||dia===6){finde+=r.horas;}else{laborables+=r.horas;}
});
document.getElementById("totalHoras").innerText=total.toFixed(2);
document.getElementById("horasLaborables").innerText=laborables.toFixed(2);
document.getElementById("horasFinde").innerText=finde.toFixed(2);
}

if("serviceWorker" in navigator){
navigator.serviceWorker.register("service-worker.js");
}

actualizarTabla();
actualizarResumen();
</script>

</body>
</html>
